<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>Финансита</title>
	<link rel="stylesheet" href="css/style.css">
</head>
<body><div id="user"></div>
	<form id="add_goods">
		<div class="input_data">
			<label>Введите товар</label>
			<input type="text" id="add_goods_name" required autofocus>
		</div>
		<div class="input_data">
			<label>Введите сумму</label>
			<input type="number" id="add_goods_price" required step="0.01" min="0">
		</div>
		<button type="submit">Добавить</button>
	</form>
	
	
	
	

	<script src="https://www.gstatic.com/firebasejs/3.7.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/3.7.1/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/3.7.1/firebase-database.js"></script>
	<script src="js/auth.js"></script>
	
	<script>
		var database = firebase.database('finance-ed0a6'); // подключение к БД
		// запись в БД
		function writeUserData(userId, name, email, imageUrl) {
		  database.ref('users/' + userId).set({
			username: name,
			email: email,
			profile_picture : imageUrl
		  });
		}
		
		
		firebase.auth().onAuthStateChanged(function(user) { // проверка на авторизованность
			var userId = firebase.auth().currentUser.uid;
			var name = firebase.auth().currentUser.name;
			var email = firebase.auth().currentUser.email;
			var imageUrl = firebase.auth().currentUser.photoURL;
			database.ref('/users/' + userId).once('value').then(function(snapshot) {
				log(snapshot)
				if(snapshot.val()){
				var username = snapshot.val().username;
				}else{
					writeUserData(userId, name, email, imageUrl);
				}
				// ...
			});
			
		})
		
			
	
		
		
	
		
		
	</script>
	
	
	<script src="js/add.js"></script>
</body>
</html>